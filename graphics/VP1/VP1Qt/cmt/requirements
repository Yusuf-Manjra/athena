package VP1Qt

author David Quarrie <David.Quarrie@cern.ch>
author Thomas Kittelmann <Thomas.Kittelmann@cern.ch>

use AtlasQt4 AtlasQt4-* External

##########################
# For building with qmake:
##########################

# this declares the script in VP1Qt/share
apply_pattern declare_scripts files="create-qt4-based-lib"
# this defines an action to be used in the pattern defined below
macro VP1Qt_createlib "create-qt4-based-lib "

# This defines the CMT "pattern" to be used in the requirements file of the other VP1 packages
# This calls: 
# 1 - the action defined above, which calls the script "VP1Qt/share/create-qt4-based-lib"...
# 2 - ...followed by the options to the script, per package, passed through the pattern "<package>_qt4options"
# If you need to add flags or options to pass to qmake, you have to edit the script "create-qt4-based-lib" 
# and then pass the options through the "<package>_qt4options" pattern.
#
pattern qt4based_library \
  action buildwithqmake "$(VP1Qt_createlib) "$(<package>_qt4options)" " ; \
  private ; \
  macro_append all_dependencies " buildwithqmake " ; \
  macro_append buildwithqmake_dependencies " install_includes " ; \
  end_private ; \
  macro <package>_linkopts "-l<package> "

#####################################
# Examples of use in client packages:
#####################################
#
#In order to build a package based on Qt4 (with the QtCore+QtGui libs):
#
#------- requirements --------
#package MyPackage
#use AtlasPolicy AtlasPolicy-*
#use VP1Qt  VP1Qt-*  graphics/VP1
#apply_pattern qt4based_library
#-----------------------------
#
#If you also need, e.g. QtXml and QtNetwork, add a line:
#
#------- requirements --------
#package MyPackage
#use AtlasPolicy AtlasPolicy-*
#use VP1Qt  VP1Qt-*  graphics/VP1
#macro MyPackage_qt4options "need:xml need:network"
#apply_pattern qt4based_library
#-----------------------------
#
#If you have to specify optional flags for "moc", add them like here below:
#
#------- requirements --------
#package MyPackage
#use AtlasPolicy AtlasPolicy-*
#use VP1Qt  VP1Qt-*  graphics/VP1
#macro MyPackage_qt4options "mocflags:-DBOOST_TT_HAS_OPERATOR_HPP_INCLUDED mocflags:-DBOOST_NO_TEMPLATE_PARTIAL_SPECIALIZATION"
#apply_pattern qt4based_library
#-----------------------------

