#####################################################################################################################
## This is a list of existing collections of beam halo events generated by Vadim Talanov in FLUKA. 
## The A files correspond to the A side of the cavern and so on. The A side should see 98% of the
## beam halo, so the imbalance is encoded in the files.
##
## Alden Stradling, 30 Nov 2007
##
## Major rework (20 Dec 2007) - introducing randomization and live update from CASTOR
#####################################################################################################################
import os, commands
from random import randint

def randomize(l):
    ''' Randomizes a list by swapping its members '''
    for i in range(len(l)*10):
        r,rr=randint(0,len(l)-1),randint(0,len(l)-1)
        l[r],l[rr]=l[rr],l[r]
    return l

path='/eos/user/s/stradlin/BeamHalo/simul'

short='pup.008850.halo_A_fluka'
cmd='nsls -l %s/%s |grep -v " 0 "|grep HITS|awk \'{print $9}\'' % (path,short)
haloAColl = ['rfio:%s/%s/%s' % (path,short,i) for i in commands.getoutput(cmd).split('\n')]

short='pup.008851.halo_C_fluka'
cmd='nsls -l %s/%s |grep -v " 0 "|grep HITS|awk \'{print $9}\'' % (path,short)
haloCColl = ['rfio:%s/%s/%s' % (path,short,i) for i in commands.getoutput(cmd).split('\n')]

# Handles the A/C imbalance - factor of 57 over 403 files
beamHaloCollections=randomize(randomize(haloAColl)+randomize(haloCColl)[:7])


