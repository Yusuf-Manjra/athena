package AtlasDPM

author David Quarrie <David.Quarrie@cern.ch>

include_path none

# This package controls access to the LCG dpm package

use AtlasExternalArea AtlasExternalArea-* External

# Don't setup the environment for DPM unless the useDPM tag is explicitly set
path_remove  PATH   "/DPM/" \
             useDPM ""

path_remove  LD_LIBRARY_PATH "/DPM/" \
             useDPM          ""

# Setup the expanded LD_LIBRARY_PATH if the useDPM tag is set

path_remove  LD_LIBRARY_PATH "/AtlasDPM/"
path_prepend LD_LIBRARY_PATH "" \
             useDPM          "$(ATLASDPMROOT)/${CMTCONFIG}"

# Remove the dpm linkopts unless the useDPM tag is set
macro_remove dpm_linkopts "-ldpm" \
             useDPM       ""

# Install symlink that overrides native CASTOR libshift.so.2.1 when
# the useDPM tag is set
private
use dpm v* LCG_Interfaces

make_fragment dpm_symlink -header=dpm_symlink_header
document      dpm_symlink dpm_symlink source=libshift.so.2.1 dest=$(dpm_home)/$(unixdirname)/libdpm.so
end_private
#---------------------------------------------------------------------
# Define post-installation actions for installation from the distribution
# kit
macro AtlasDPM_pacman_post_install "cmt make"
