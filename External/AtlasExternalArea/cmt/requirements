package AtlasExternalArea

author ATLAS Software Librarian <ATLAS-Software.Librarian@cern.ch>

use LCG_Settings v*
use PlatformPolicy PlatformPolicy-* External

set ATLAS_EXTERNAL "${SITEROOT}/atlas/offline/external" \
    BNL            "${SITEROOT}/offline/external" \
    LBNL           "${SITEROOT}/local/offline/external" \
    EXTSITE        "${SITEROOT}/external" \
    STANDALONE     "${SITEROOT}/external"

macro LCG_ROOT     "${SITEROOT}/sw/lcg" \
      BNL	   "${SITEROOT}/cernsw/lcg

macro LCG_EXTERNAL "${LCG_ROOT}/external"

# System name for LCG applications software
macro LCG_app_system   "$(LCG_platform)"

# System name for LCG external software
macro LCG_ext_system "$(LCG_system)"

# We should probably revisit this and decide on whether a different 
# interface package should be created for the common packages area.
macro COMMON_PACKAGES "${SITEROOT}/sw/packages" \
      BNL             "${SITEROOT}/cernsw/packages" \
      EXTSITE         "${SITEROOT}/packages" \
      STANDALONE      "${SITEROOT}/packages"

#
# In case <package> exports external s/w,
# check mandatory distribution kit related macros,
# <package>_export_paths and <package>_native_version,
# expected by PackDist distribution kit building tool
#

#
# Errors can be turned into warnings by specifying
# macro <package>_pedantic_level value of WARNING or warning
# or
# unsetting PEDANTIC environment variable
#
pattern -global pack_dist_check \
    private ; \
    macro need_pack_dist_check    "" \
          Unix "`test -z '$(<package>_export_paths)'&&echo no_pack_dist_check||echo do_pack_dist_check`" ; \
    apply_tag $(need_pack_dist_check) ; \
    action pack_dist_check    "" \
           do_pack_dist_check "$(ATLASEXTERNALAREAROOT)/share/pack_dist_check.sh -package=<package> -files='$(<package>_export_paths)' -version=$(<package>_native_version) -level=$(<package>_pedantic_level)" ; \
    macro_append all_dependencies   "" \
           do_pack_dist_check " pack_dist_check" ; \
    end_private

#  document pack_dist_checker <package>_pack_dist_checker

#make_fragment pack_dist_checker_header
#make_fragment pack_dist_checker -header=pack_dist_checker_header
