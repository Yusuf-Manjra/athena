package AtlasPython

author David Quarrie      <David.Quarrie@cern.ch>

use ExternalPolicy ExternalPolicy-00-* External
use Python v* LCG_Interfaces

# workaround. see bug #51501
set EXTRA_CFLAGS "" target-i686 "-m32"

# Remove the Python system libraries from PYTHONPATH since its both
# unnecessary and causes problems with Ganga. Note that this will
# no longer be necessary from LCGCMT_55a onwards
####path_remove PYTHONPATH "$(Python_home)/lib/"

### ---------------------------------------------------------------------------
### support for distutils-based python packages
###
pattern distutils_build \
   macro_append constituents " distutils_build_<name>" ; \
   private ; \
    use PyCmt         PyCmt-*		Tools -no_auto_imports ; \
   end_private ; \
   macro distutils_build_<name>_dependencies "" ; \
   action distutils_build_<name> "$(AtlasPython_root)/cmt/distutils-build.py --name=<name> --src-dir='<src_dir>' --install-dir='$(CMTINSTALLAREA)/<install_dir>'" ;

macro py_distutils_ldflags "$(Python_linkopts) -shared $(cpplinkflags) $(cmt_installarea_linkopts)"

macro py_distutils_cc "$(cc) -fno-strict-aliasing"
macro py_distutils_cflags "$(cflags) -fno-strict-aliasing"
macro_append py_distutils_cflags " $(cppflags) $(cppdebugflags)"
macro_remove py_distutils_cflags "-Woverloaded-virtual"

macro py_distutils_cxx "$(cpp) -fno-strict-aliasing"
macro py_distutils_cxxflags "$(cppflags) $(cppdebugflags)"

macro py_distutils_fcompiler "$(for)"
macro py_distutils_fflags    "$(fflags)"

# note: this is the autoconf meaning of CPPFLAGS (ie: a list of -I<incl dir>)
macro py_distutils_cppflags "$(includes)"
