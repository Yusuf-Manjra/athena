*
*
*
*

* Author : Saclay Muon Software Group (SaMuSoG)
***************************************************************************
      SUBROUTINE GBMAGLNOTOR(AVER,RFZSC,II312, BXYZ,
     +NVERSION,BINNER,RMAINN,ZMAINN,RTORI,ZTORI,RTORO,ZTORO,EPS0,
     +SECMAG,NRMAG,NFMAG,NZMAG,RMAG ,FMAG ,ZMAG ,BRMAG,BFMAG,BZMAG,
     +SECFEL,NRR  ,NFF  ,NZZ  ,RRPOS,FFPOS,ZZPOS,TABBR,TABBF,TABBZ,
     +DRPOS,RPOSMI,DFPOS,FPOSMI,DZPOS,ZPOSMI,JRPOS,JFPOS,JZPOS,
     +DRMAG,RMAGMI,RMAGMA,DFMAG,FMAGMI,DZMAG,ZMAGMI,JRMAG,JFMAG,JZMAG)
*
*>> Interpolates tabulated nonlinear 3D ATLAS mag. field BXYZ !
*>> Author : Saclay Muon Software Group (SaMuSoG)
*>> Date   :  8/09/98
*
      IMPLICIT NONE
*
*
      CHARACTER*4 AVER
      INTEGER II312, NVERSION, NRMAG(*),NFMAG,NZMAG, NRR,NFF,NZZ
      INTEGER JRPOS(*),JFPOS(*),JZPOS(*), JRMAG(*),JFMAG(*),JZMAG(*) 
      REAL    RFZSC(6), BXYZ(12), BINNER, RMAINN, ZMAINN
      REAL    RTORI, ZTORI, RTORO, ZTORO, EPS0, SECMAG, SECFEL
      REAL    RMAG(*),FMAG(*),ZMAG(*), BRMAG(*),BFMAG(*),BZMAG(*)
      REAL    RRPOS(*),FFPOS(*),ZZPOS(*), TABBR(*),TABBF(*),TABBZ(*)
      REAL    DRPOS,RPOSMI,DFPOS,FPOSMI,DZPOS,ZPOSMI
      REAL    DRMAG,RMAGMI,RMAGMA,DFMAG,FMAGMI,DZMAG,ZMAGMI
*
      INTEGER I
      REAL    RR,AZ
      REAL    BXYZBS(12)
*
      real*8  zero,deg,pi
*
      RR = RFZSC(1)
      AZ = RFZSC(6)      
      zero = 0
      pi   = 3.141592654
      deg  = 180./pi

      IF( RR.LT.RTORI .AND. AZ.LT.ZTORI ) THEN
        CALL BFELIXXX( SECFEL, NRR,NFF,NZZ, RRPOS,FFPOS,ZZPOS,
     +  TABBR,TABBF,TABBZ,
     +  DRPOS,RPOSMI,DFPOS,FPOSMI,DZPOS,ZPOSMI,JRPOS,JFPOS,JZPOS,
     +  DRMAG,RMAGMI,RMAGMA,DFMAG,FMAGMI,DZMAG,ZMAGMI,JRMAG,JFMAG,JZMAG,
     +                  RFZSC,II312, BXYZ )
*
* 	WRITE(96,'(3f9.1,6F9.4)')RFZSC(1),RFZSC(2)*deg,RFZSC(3),
*     + zero,zero,zero,BXYZ(1),BXYZ(2),BXYZ(3)
*
      ELSE
        CALL BINMAGXX( SECMAG, NRMAG,NFMAG,NZMAG, RMAG,FMAG,ZMAG,
     +  BRMAG,BFMAG,BZMAG, 
     +  DRPOS,RPOSMI,DFPOS,FPOSMI,DZPOS,ZPOSMI,JRPOS,JFPOS,JZPOS,
     +  DRMAG,RMAGMI,RMAGMA,DFMAG,FMAGMI,DZMAG,ZMAGMI,JRMAG,JFMAG,JZMAG,
     +                  RFZSC,II312, BXYZ)        
      ENDIF		
*
      RETURN
      END

